<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南</title>
  <meta name="description" content="第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南" />
  <meta name="github-repo" content="cosname/rmarkdown-guide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南" />
  
  <meta name="twitter:description" content="第 11 章 其它使用 knitr 的小技巧 | R Markdown 指南" />
  

<meta name="author" content="王祎帆" />
<meta name="author" content="闫求识" />
<meta name="author" content="高春辉" />


<meta name="date" content="2021-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="output-hooks.html"/>
<link rel="next" href="other-languages.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Markdown 中文指南</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I 基础</b></span></li>
<li class="chapter" data-level="1" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html"><i class="fa fa-check"></i><b>1</b> 认识 R Markdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#数据分析报告和文档"><i class="fa fa-check"></i><b>1.1</b> 数据分析报告和文档</a></li>
<li class="chapter" data-level="1.2" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#个人简历"><i class="fa fa-check"></i><b>1.2</b> 个人简历</a></li>
<li class="chapter" data-level="1.3" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#网站"><i class="fa fa-check"></i><b>1.3</b> 网站</a></li>
<li class="chapter" data-level="1.4" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#幻灯片"><i class="fa fa-check"></i><b>1.4</b> 幻灯片</a></li>
<li class="chapter" data-level="1.5" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#交互报表"><i class="fa fa-check"></i><b>1.5</b> 交互报表</a></li>
<li class="chapter" data-level="1.6" data-path="know-rmarkdown.html"><a href="know-rmarkdown.html#r-markdown-的渊源与历史"><i class="fa fa-check"></i><b>1.6</b> R Markdown 的渊源与历史</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> 安装</a>
<ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#安装-r-markdown"><i class="fa fa-check"></i><b>2.1</b> 安装 R Markdown</a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#create-first-rmd"><i class="fa fa-check"></i><b>2.2</b> 创建第一个 R Markdown 文档</a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#安装-tinytex"><i class="fa fa-check"></i><b>2.3</b> 安装 Tinytex</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html"><i class="fa fa-check"></i><b>3</b> 基础知识</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html#再看-html-输出文件"><i class="fa fa-check"></i><b>3.1</b> 再看 HTML 输出文件</a></li>
<li class="chapter" data-level="3.2" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html#markdown-语法"><i class="fa fa-check"></i><b>3.2</b> Markdown 语法</a></li>
<li class="chapter" data-level="3.3" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html#使用-r-代码"><i class="fa fa-check"></i><b>3.3</b> 使用 R 代码</a></li>
<li class="chapter" data-level="3.4" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html#输出格式"><i class="fa fa-check"></i><b>3.4</b> 输出格式</a></li>
<li class="chapter" data-level="3.5" data-path="rmarkdown-basics.html"><a href="rmarkdown-basics.html#r-markdown-的编译过程"><i class="fa fa-check"></i><b>3.5</b> R Markdown 的编译过程</a></li>
</ul></li>
<li class="part"><span><b>II 输出”万花筒”</b></span></li>
<li class="chapter" data-level="4" data-path="document.html"><a href="document.html"><i class="fa fa-check"></i><b>4</b> 常用文档格式</a></li>
<li class="chapter" data-level="5" data-path="html-document.html"><a href="html-document.html"><i class="fa fa-check"></i><b>5</b> 从 R Markdown 到 HTML 文档</a>
<ul>
<li class="chapter" data-level="5.1" data-path="html-document.html"><a href="html-document.html#目录和标题"><i class="fa fa-check"></i><b>5.1</b> 目录和标题</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="html-document.html"><a href="html-document.html#显示目录"><i class="fa fa-check"></i><b>5.1.1</b> 显示目录</a></li>
<li class="chapter" data-level="5.1.2" data-path="html-document.html"><a href="html-document.html#悬停目录"><i class="fa fa-check"></i><b>5.1.2</b> 悬停目录</a></li>
<li class="chapter" data-level="5.1.3" data-path="html-document.html"><a href="html-document.html#显示标题编号"><i class="fa fa-check"></i><b>5.1.3</b> 显示标题编号</a></li>
<li class="chapter" data-level="5.1.4" data-path="html-document.html"><a href="html-document.html#使用标签页"><i class="fa fa-check"></i><b>5.1.4</b> 使用标签页</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="html-document.html"><a href="html-document.html#appearance-and-style"><i class="fa fa-check"></i><b>5.2</b> 主题和样式</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="html-document.html"><a href="html-document.html#可选主题"><i class="fa fa-check"></i><b>5.2.1</b> 可选主题</a></li>
<li class="chapter" data-level="5.2.2" data-path="html-document.html"><a href="html-document.html#代码高亮"><i class="fa fa-check"></i><b>5.2.2</b> 代码高亮</a></li>
<li class="chapter" data-level="5.2.3" data-path="html-document.html"><a href="html-document.html#style-css"><i class="fa fa-check"></i><b>5.2.3</b> 自定义样式表</a></li>
<li class="chapter" data-level="5.2.4" data-path="html-document.html"><a href="html-document.html#通过-css-代码块定义样式"><i class="fa fa-check"></i><b>5.2.4</b> 通过 CSS 代码块定义样式</a></li>
<li class="chapter" data-level="5.2.5" data-path="html-document.html"><a href="html-document.html#使用丰富多样的内置-css-样式"><i class="fa fa-check"></i><b>5.2.5</b> 使用丰富多样的内置 CSS 样式</a></li>
<li class="chapter" data-level="5.2.6" data-path="html-document.html"><a href="html-document.html#代码折叠"><i class="fa fa-check"></i><b>5.2.6</b> 代码折叠</a></li>
<li class="chapter" data-level="5.2.7" data-path="html-document.html"><a href="html-document.html#html-scroll"><i class="fa fa-check"></i><b>5.2.7</b> 设置代码块内容可滚动</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="html-document.html"><a href="html-document.html#图片和数据框"><i class="fa fa-check"></i><b>5.3</b> 图片和数据框</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="html-document.html"><a href="html-document.html#设置图片的属性"><i class="fa fa-check"></i><b>5.3.1</b> 设置图片的属性</a></li>
<li class="chapter" data-level="5.3.2" data-path="html-document.html"><a href="html-document.html#插入外源图片"><i class="fa fa-check"></i><b>5.3.2</b> 插入外源图片</a></li>
<li class="chapter" data-level="5.3.3" data-path="html-document.html"><a href="html-document.html#输出数据框"><i class="fa fa-check"></i><b>5.3.3</b> 输出数据框</a></li>
<li class="chapter" data-level="5.3.4" data-path="html-document.html"><a href="html-document.html#分页打印数据框时的附加参数"><i class="fa fa-check"></i><b>5.3.4</b> 分页打印数据框时的附加参数</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="html-document.html"><a href="html-document.html#组件和内容"><i class="fa fa-check"></i><b>5.4</b> 组件和内容</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="html-document.html"><a href="html-document.html#理解-html-文档的依赖关系"><i class="fa fa-check"></i><b>5.4.1</b> 理解 HTML 文档的依赖关系</a></li>
<li class="chapter" data-level="5.4.2" data-path="html-document.html"><a href="html-document.html#mathjax-库的配置"><i class="fa fa-check"></i><b>5.4.2</b> MathJax 库的配置</a></li>
<li class="chapter" data-level="5.4.3" data-path="html-document.html"><a href="html-document.html#是否保留-markdown"><i class="fa fa-check"></i><b>5.4.3</b> 是否保留 Markdown</a></li>
<li class="chapter" data-level="5.4.4" data-path="html-document.html"><a href="html-document.html#使用自定义的-html-模板"><i class="fa fa-check"></i><b>5.4.4</b> 使用自定义的 HTML 模板</a></li>
<li class="chapter" data-level="5.4.5" data-path="html-document.html"><a href="html-document.html#include-html"><i class="fa fa-check"></i><b>5.4.5</b> 包含其它文件</a></li>
<li class="chapter" data-level="5.4.6" data-path="html-document.html"><a href="html-document.html#html-fragments"><i class="fa fa-check"></i><b>5.4.6</b> 生成 HTML 片段</a></li>
<li class="chapter" data-level="5.4.7" data-path="html-document.html"><a href="html-document.html#使用自定义的浏览器图标"><i class="fa fa-check"></i><b>5.4.7</b> 使用自定义的浏览器图标</a></li>
<li class="chapter" data-level="5.4.8" data-path="html-document.html"><a href="html-document.html#共用-yaml-配置文件"><i class="fa fa-check"></i><b>5.4.8</b> 共用 YAML 配置文件</a></li>
<li class="chapter" data-level="5.4.9" data-path="html-document.html"><a href="html-document.html#嵌入-rmd-源文件"><i class="fa fa-check"></i><b>5.4.9</b> 嵌入 Rmd 源文件</a></li>
<li class="chapter" data-level="5.4.10" data-path="html-document.html"><a href="html-document.html#嵌入其它文件"><i class="fa fa-check"></i><b>5.4.10</b> 嵌入其它文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="PDF-document.html"><a href="PDF-document.html"><i class="fa fa-check"></i><b>6</b> PDF 文档</a>
<ul>
<li class="chapter" data-level="6.1" data-path="PDF-document.html"><a href="PDF-document.html#安装-tinytex-1"><i class="fa fa-check"></i><b>6.1</b> 安装 <code>TinyTex</code></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="PDF-document.html"><a href="PDF-document.html#安装-latex-组件"><i class="fa fa-check"></i><b>6.1.1</b> 安装 LaTeX 组件</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="PDF-document.html"><a href="PDF-document.html#从-r-markdown-到-pdf-文档"><i class="fa fa-check"></i><b>6.2</b> 从 R Markdown 到 PDF 文档</a></li>
<li class="chapter" data-level="6.3" data-path="PDF-document.html"><a href="PDF-document.html#在-pdf-文档中使用中文的注意事项"><i class="fa fa-check"></i><b>6.3</b> 在 PDF 文档中使用中文的注意事项</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="PDF-document.html"><a href="PDF-document.html#显示目录-1"><i class="fa fa-check"></i><b>6.3.1</b> 显示目录</a></li>
<li class="chapter" data-level="6.3.2" data-path="PDF-document.html"><a href="PDF-document.html#图片相关的配置"><i class="fa fa-check"></i><b>6.3.2</b> 图片相关的配置</a></li>
<li class="chapter" data-level="6.3.3" data-path="PDF-document.html"><a href="PDF-document.html#打印数据框"><i class="fa fa-check"></i><b>6.3.3</b> 打印数据框</a></li>
<li class="chapter" data-level="6.3.4" data-path="PDF-document.html"><a href="PDF-document.html#代码高亮-1"><i class="fa fa-check"></i><b>6.3.4</b> 代码高亮</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="PDF-document.html"><a href="PDF-document.html#latex-选项"><i class="fa fa-check"></i><b>6.4</b> LaTeX 选项</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="PDF-document.html"><a href="PDF-document.html#通用文档部件"><i class="fa fa-check"></i><b>6.4.1</b> 通用文档部件</a></li>
<li class="chapter" data-level="6.4.2" data-path="PDF-document.html"><a href="PDF-document.html#选择-latex-模板"><i class="fa fa-check"></i><b>6.4.2</b> 选择 LaTeX 模板</a></li>
<li class="chapter" data-level="6.4.3" data-path="PDF-document.html"><a href="PDF-document.html#配置-latex-模板的参数"><i class="fa fa-check"></i><b>6.4.3</b> 配置 LaTeX 模板的参数</a></li>
<li class="chapter" data-level="6.4.4" data-path="PDF-document.html"><a href="PDF-document.html#使用-latex-包处理引用"><i class="fa fa-check"></i><b>6.4.4</b> 使用 LaTeX 包处理引用</a></li>
<li class="chapter" data-level="6.4.5" data-path="PDF-document.html"><a href="PDF-document.html#latex-的渲染引擎"><i class="fa fa-check"></i><b>6.4.5</b> LaTeX 的渲染引擎</a></li>
<li class="chapter" data-level="6.4.6" data-path="PDF-document.html"><a href="PDF-document.html#保留生成的-tex-中间文件"><i class="fa fa-check"></i><b>6.4.6</b> 保留生成的 TeX 中间文件</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="presentation.html"><a href="presentation.html"><i class="fa fa-check"></i><b>7</b> 演示文稿</a>
<ul>
<li class="chapter" data-level="7.1" data-path="presentation.html"><a href="presentation.html#rmarkdown-basic-presentation"><i class="fa fa-check"></i><b>7.1</b> R Markdown 基础幻灯片</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="presentation.html"><a href="presentation.html#ioslides-presentation"><i class="fa fa-check"></i><b>7.1.1</b> ioslides 幻灯片</a></li>
<li class="chapter" data-level="7.1.2" data-path="presentation.html"><a href="presentation.html#slidy-presentation"><i class="fa fa-check"></i><b>7.1.2</b> Slidy 幻灯片</a></li>
<li class="chapter" data-level="7.1.3" data-path="presentation.html"><a href="presentation.html#beamer-presentation"><i class="fa fa-check"></i><b>7.1.3</b> Beamer 演示文稿</a></li>
<li class="chapter" data-level="7.1.4" data-path="presentation.html"><a href="presentation.html#powerpoint-presentation"><i class="fa fa-check"></i><b>7.1.4</b> PowerPoint 演示文稿</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="presentation.html"><a href="presentation.html#xaringan-presentation"><i class="fa fa-check"></i><b>7.2</b> Xaringan 幻灯片</a></li>
</ul></li>
<li class="part"><span><b>III 操作技巧</b></span></li>
<li class="chapter" data-level="8" data-path="table.html"><a href="table.html"><i class="fa fa-check"></i><b>8</b> 表格操作</a>
<ul>
<li class="chapter" data-level="8.1" data-path="table.html"><a href="table.html#kable"><i class="fa fa-check"></i><b>8.1</b> 表格生成函数 <code>knitr::kable()</code></a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="table.html"><a href="table.html#kable-formats"><i class="fa fa-check"></i><b>8.1.1</b> 已支持的表的格式</a></li>
<li class="chapter" data-level="8.1.2" data-path="table.html"><a href="table.html#修改列名"><i class="fa fa-check"></i><b>8.1.2</b> 修改列名</a></li>
<li class="chapter" data-level="8.1.3" data-path="table.html"><a href="table.html#指定列的对齐方式"><i class="fa fa-check"></i><b>8.1.3</b> 指定列的对齐方式</a></li>
<li class="chapter" data-level="8.1.4" data-path="table.html"><a href="table.html#kable-caption"><i class="fa fa-check"></i><b>8.1.4</b> 添加表格标题</a></li>
<li class="chapter" data-level="8.1.5" data-path="table.html"><a href="table.html#调整数字格式"><i class="fa fa-check"></i><b>8.1.5</b> 调整数字格式</a></li>
<li class="chapter" data-level="8.1.6" data-path="table.html"><a href="table.html#显示缺失值"><i class="fa fa-check"></i><b>8.1.6</b> 显示缺失值</a></li>
<li class="chapter" data-level="8.1.7" data-path="table.html"><a href="table.html#特殊字符的转义"><i class="fa fa-check"></i><b>8.1.7</b> 特殊字符的转义</a></li>
<li class="chapter" data-level="8.1.8" data-path="table.html"><a href="table.html#多张表格并排"><i class="fa fa-check"></i><b>8.1.8</b> 多张表格并排</a></li>
<li class="chapter" data-level="8.1.9" data-path="table.html"><a href="table.html#利用for循环生成多个表"><i class="fa fa-check"></i><b>8.1.9</b> 利用<code>for</code>循环生成多个表 (*)</a></li>
<li class="chapter" data-level="8.1.10" data-path="table.html"><a href="table.html#自定义-latex-表格"><i class="fa fa-check"></i><b>8.1.10</b> 自定义 LaTex 表格 (*)</a></li>
<li class="chapter" data-level="8.1.11" data-path="table.html"><a href="table.html#自定义-html-表格"><i class="fa fa-check"></i><b>8.1.11</b> 自定义 HTML 表格 (*)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="table.html"><a href="table.html#kableextra"><i class="fa fa-check"></i><b>8.2</b> <strong>kableExtra</strong> 包</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="table.html"><a href="table.html#设定字体尺寸"><i class="fa fa-check"></i><b>8.2.1</b> 设定字体尺寸</a></li>
<li class="chapter" data-level="8.2.2" data-path="table.html"><a href="table.html#特定的行或列的样式"><i class="fa fa-check"></i><b>8.2.2</b> 特定的行或列的样式</a></li>
<li class="chapter" data-level="8.2.3" data-path="table.html"><a href="table.html#给行或列分组"><i class="fa fa-check"></i><b>8.2.3</b> 给行或列分组</a></li>
<li class="chapter" data-level="8.2.4" data-path="table.html"><a href="table.html#按比例缩小latex中的表格"><i class="fa fa-check"></i><b>8.2.4</b> 按比例缩小LaTex中的表格</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="table.html"><a href="table.html#table-other"><i class="fa fa-check"></i><b>8.3</b> 其它生成表格的包</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chunk-options.html"><a href="chunk-options.html"><i class="fa fa-check"></i><b>9</b> 块选项</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chunk-options.html"><a href="chunk-options.html#chunk-variable"><i class="fa fa-check"></i><b>9.1</b> 在块选项中使用变量</a></li>
<li class="chapter" data-level="9.2" data-path="chunk-options.html"><a href="chunk-options.html#opts-error"><i class="fa fa-check"></i><b>9.2</b> 如何在遇到 error 的时候继续编译</a></li>
<li class="chapter" data-level="9.3" data-path="chunk-options.html"><a href="chunk-options.html#dev-vector"><i class="fa fa-check"></i><b>9.3</b> 同一张图的多种图像输出格式</a></li>
<li class="chapter" data-level="9.4" data-path="chunk-options.html"><a href="chunk-options.html#cache"><i class="fa fa-check"></i><b>9.4</b> 缓存耗时的代码块</a></li>
<li class="chapter" data-level="9.5" data-path="chunk-options.html"><a href="chunk-options.html#cache-path"><i class="fa fa-check"></i><b>9.5</b> 为多种输出格式缓存代码块</a></li>
<li class="chapter" data-level="9.6" data-path="chunk-options.html"><a href="chunk-options.html#cache-lazy"><i class="fa fa-check"></i><b>9.6</b> 缓存大型的对象</a></li>
<li class="chapter" data-level="9.7" data-path="chunk-options.html"><a href="chunk-options.html#hide-one"><i class="fa fa-check"></i><b>9.7</b> 隐藏源代码、message、warning、文本输出或图像输出</a></li>
<li class="chapter" data-level="9.8" data-path="chunk-options.html"><a href="chunk-options.html#hide-all"><i class="fa fa-check"></i><b>9.8</b> 隐藏代码块的所有输出</a></li>
<li class="chapter" data-level="9.9" data-path="chunk-options.html"><a href="chunk-options.html#opts-collapse"><i class="fa fa-check"></i><b>9.9</b> 将文本输出压缩到源代码块中</a></li>
<li class="chapter" data-level="9.10" data-path="chunk-options.html"><a href="chunk-options.html#opts-tidy"><i class="fa fa-check"></i><b>9.10</b> 重新格式化源代码</a></li>
<li class="chapter" data-level="9.11" data-path="chunk-options.html"><a href="chunk-options.html#results-asis"><i class="fa fa-check"></i><b>9.11</b> 将输出文本作为原始的Markdown的内容 (*)</a></li>
<li class="chapter" data-level="9.12" data-path="chunk-options.html"><a href="chunk-options.html#opts-comment"><i class="fa fa-check"></i><b>9.12</b> 删除文本输出中的前导符号</a></li>
<li class="chapter" data-level="9.13" data-path="chunk-options.html"><a href="chunk-options.html#attr-output"><i class="fa fa-check"></i><b>9.13</b> 为文本输出块添加属性 (*)</a></li>
<li class="chapter" data-level="9.14" data-path="chunk-options.html"><a href="chunk-options.html#fig-process"><i class="fa fa-check"></i><b>9.14</b> 图像的后期加工 (*)</a></li>
<li class="chapter" data-level="9.15" data-path="chunk-options.html"><a href="chunk-options.html#graphical-device"><i class="fa fa-check"></i><b>9.15</b> 高质量的图像 (*)</a></li>
<li class="chapter" data-level="9.16" data-path="chunk-options.html"><a href="chunk-options.html#low-plots"><i class="fa fa-check"></i><b>9.16</b> 带有低级绘图功能的逐步绘图 (*)</a></li>
<li class="chapter" data-level="9.17" data-path="chunk-options.html"><a href="chunk-options.html#opts-render"><i class="fa fa-check"></i><b>9.17</b> 在代码块中自定义对象的打印格式 (*)</a></li>
<li class="chapter" data-level="9.18" data-path="chunk-options.html"><a href="chunk-options.html#option-hooks"><i class="fa fa-check"></i><b>9.18</b> 选项钩子 (*)</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="output-hooks.html"><a href="output-hooks.html"><i class="fa fa-check"></i><b>10</b> 输出钩子 (*)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="output-hooks.html"><a href="output-hooks.html#hook-hide"><i class="fa fa-check"></i><b>10.1</b> 编辑源代码</a></li>
<li class="chapter" data-level="10.2" data-path="output-hooks.html"><a href="output-hooks.html#hook-number"><i class="fa fa-check"></i><b>10.2</b> 向源代码中添加行号</a></li>
<li class="chapter" data-level="10.3" data-path="output-hooks.html"><a href="output-hooks.html#hook-scroll"><i class="fa fa-check"></i><b>10.3</b> 可滚动的文本输出</a></li>
<li class="chapter" data-level="10.4" data-path="output-hooks.html"><a href="output-hooks.html#hook-truncate"><i class="fa fa-check"></i><b>10.4</b> 截断文本输出</a></li>
<li class="chapter" data-level="10.5" data-path="output-hooks.html"><a href="output-hooks.html#hook-html5"><i class="fa fa-check"></i><b>10.5</b> 以HTML5格式输出图像</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="knitr-misc.html"><a href="knitr-misc.html"><i class="fa fa-check"></i><b>11</b> 其它使用 knitr 的小技巧</a>
<ul>
<li class="chapter" data-level="11.1" data-path="knitr-misc.html"><a href="knitr-misc.html#reuse-chunks"><i class="fa fa-check"></i><b>11.1</b> 重复使用代码块</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="knitr-misc.html"><a href="knitr-misc.html#embed-chunk"><i class="fa fa-check"></i><b>11.1.1</b> 将一个块嵌入到另一个块中 (*)</a></li>
<li class="chapter" data-level="11.1.2" data-path="knitr-misc.html"><a href="knitr-misc.html#same-label"><i class="fa fa-check"></i><b>11.1.2</b> 在另一个块中使用相同的块标签</a></li>
<li class="chapter" data-level="11.1.3" data-path="knitr-misc.html"><a href="knitr-misc.html#ref-label"><i class="fa fa-check"></i><b>11.1.3</b> 使用引用标签 (*)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="knitr-misc.html"><a href="knitr-misc.html#load-cache"><i class="fa fa-check"></i><b>11.2</b> 在创建对象之前使用它 (*)</a></li>
<li class="chapter" data-level="11.3" data-path="knitr-misc.html"><a href="knitr-misc.html#knit-exit"><i class="fa fa-check"></i><b>11.3</b> 提前退出编译</a></li>
<li class="chapter" data-level="11.4" data-path="knitr-misc.html"><a href="knitr-misc.html#fig-chunk"><i class="fa fa-check"></i><b>11.4</b> 生成一个图像并在其他地方显示</a></li>
<li class="chapter" data-level="11.5" data-path="knitr-misc.html"><a href="knitr-misc.html#global-device"><i class="fa fa-check"></i><b>11.5</b> 修改前一个代码块中的图像</a></li>
<li class="chapter" data-level="11.6" data-path="knitr-misc.html"><a href="knitr-misc.html#opts-template"><i class="fa fa-check"></i><b>11.6</b> 保存一组块选项并重复使用它们 (*)</a></li>
<li class="chapter" data-level="11.7" data-path="knitr-misc.html"><a href="knitr-misc.html#knit-expand"><i class="fa fa-check"></i><b>11.7</b> 使用 <code>knitr::knit_expand()</code> 来生成 Rmd 源代码</a></li>
<li class="chapter" data-level="11.8" data-path="knitr-misc.html"><a href="knitr-misc.html#duplicate-label"><i class="fa fa-check"></i><b>11.8</b> 允许代码块中的标签重复 Allow duplicate labels in code chunks (*)</a></li>
<li class="chapter" data-level="11.9" data-path="knitr-misc.html"><a href="knitr-misc.html#cache-rds"><i class="fa fa-check"></i><b>11.9</b> 一个更透明的缓存机制</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="knitr-misc.html"><a href="knitr-misc.html#通过更改表达式中的代码使缓存失效"><i class="fa fa-check"></i><b>11.9.1</b> 通过更改表达式中的代码使缓存失效</a></li>
<li class="chapter" data-level="11.9.2" data-path="knitr-misc.html"><a href="knitr-misc.html#通过更改全局变量使缓存失效"><i class="fa fa-check"></i><b>11.9.2</b> 通过更改全局变量使缓存失效</a></li>
<li class="chapter" data-level="11.9.3" data-path="knitr-misc.html"><a href="knitr-misc.html#保留缓存的多个副本"><i class="fa fa-check"></i><b>11.9.3</b> 保留缓存的多个副本</a></li>
<li class="chapter" data-level="11.9.4" data-path="knitr-misc.html"><a href="knitr-misc.html#与knitr的缓存比较"><i class="fa fa-check"></i><b>11.9.4</b> 与<strong>knitr</strong>的缓存比较</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 第四部分：进阶操作</b></span></li>
<li class="chapter" data-level="12" data-path="other-languages.html"><a href="other-languages.html"><i class="fa fa-check"></i><b>12</b> 与其他语言的结合</a>
<ul>
<li class="chapter" data-level="12.1" data-path="other-languages.html"><a href="other-languages.html#custom-engine"><i class="fa fa-check"></i><b>12.1</b> 注册自定义语言引擎（*）</a></li>
<li class="chapter" data-level="12.2" data-path="other-languages.html"><a href="other-languages.html#eng-python"><i class="fa fa-check"></i><b>12.2</b> 运行 Python 代码并与 Python 交互</a></li>
<li class="chapter" data-level="12.3" data-path="other-languages.html"><a href="other-languages.html#eng-asis"><i class="fa fa-check"></i><b>12.3</b> 通过 <code>asis</code> 引擎有条件地执行内容</a></li>
<li class="chapter" data-level="12.4" data-path="other-languages.html"><a href="other-languages.html#eng-bash"><i class="fa fa-check"></i><b>12.4</b> 执行 Shell 脚本</a></li>
<li class="chapter" data-level="12.5" data-path="other-languages.html"><a href="other-languages.html#d3"><i class="fa fa-check"></i><b>12.5</b> 用 D3 可视化</a></li>
<li class="chapter" data-level="12.6" data-path="other-languages.html"><a href="other-languages.html#eng-cat"><i class="fa fa-check"></i><b>12.6</b> 通过 <code>cat</code> 引擎将块内容写入文件</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="other-languages.html"><a href="other-languages.html#写入-css-文件"><i class="fa fa-check"></i><b>12.6.1</b> 写入 CSS 文件</a></li>
<li class="chapter" data-level="12.6.2" data-path="other-languages.html"><a href="other-languages.html#在序言中包含-latex-代码"><i class="fa fa-check"></i><b>12.6.2</b> 在序言中包含 LaTeX 代码</a></li>
<li class="chapter" data-level="12.6.3" data-path="other-languages.html"><a href="other-languages.html#将-yaml-数据写入文件并显示它"><i class="fa fa-check"></i><b>12.6.3</b> 将 YAML 数据写入文件并显示它</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="other-languages.html"><a href="other-languages.html#eng-sas"><i class="fa fa-check"></i><b>12.7</b> 运行 SAS 代码</a></li>
<li class="chapter" data-level="12.8" data-path="other-languages.html"><a href="other-languages.html#eng-stata"><i class="fa fa-check"></i><b>12.8</b> 运行 Stata 代码</a></li>
<li class="chapter" data-level="12.9" data-path="other-languages.html"><a href="other-languages.html#eng-asy"><i class="fa fa-check"></i><b>12.9</b> 用渐近线 Asymptote 创建图形</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="other-languages.html"><a href="other-languages.html#在r中生成数据并通过-asymptote-读取"><i class="fa fa-check"></i><b>12.9.1</b> 在R中生成数据并通过 Asymptote 读取</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="other-languages.html"><a href="other-languages.html#eng-sass"><i class="fa fa-check"></i><b>12.10</b> 使用 Sass/SCSS 构建 HTML 页面风格</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="Dashboards.html"><a href="Dashboards.html"><i class="fa fa-check"></i><b>13</b> Dashboards</a>
<ul>
<li class="chapter" data-level="13.1" data-path="Dashboards.html"><a href="Dashboards.html#入门"><i class="fa fa-check"></i><b>13.1</b> 入门</a></li>
<li class="chapter" data-level="13.2" data-path="Dashboards.html"><a href="Dashboards.html#排版"><i class="fa fa-check"></i><b>13.2</b> 排版</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="Dashboards.html"><a href="Dashboards.html#基于行的布局"><i class="fa fa-check"></i><b>13.2.1</b> 基于行的布局</a></li>
<li class="chapter" data-level="13.2.2" data-path="Dashboards.html"><a href="Dashboards.html#节属性"><i class="fa fa-check"></i><b>13.2.2</b> 节属性</a></li>
<li class="chapter" data-level="13.2.3" data-path="Dashboards.html"><a href="Dashboards.html#多页"><i class="fa fa-check"></i><b>13.2.3</b> 多页</a></li>
<li class="chapter" data-level="13.2.4" data-path="Dashboards.html"><a href="Dashboards.html#故事板"><i class="fa fa-check"></i><b>13.2.4</b> 故事板</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="Dashboards.html"><a href="Dashboards.html#dashboard-components"><i class="fa fa-check"></i><b>13.3</b> 组件</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="Dashboards.html"><a href="Dashboards.html#数值框"><i class="fa fa-check"></i><b>13.3.1</b> 数值框</a></li>
<li class="chapter" data-level="13.3.2" data-path="Dashboards.html"><a href="Dashboards.html#仪表"><i class="fa fa-check"></i><b>13.3.2</b> 仪表</a></li>
<li class="chapter" data-level="13.3.3" data-path="Dashboards.html"><a href="Dashboards.html#文本注释"><i class="fa fa-check"></i><b>13.3.3</b> 文本注释</a></li>
<li class="chapter" data-level="13.3.4" data-path="Dashboards.html"><a href="Dashboards.html#导航栏"><i class="fa fa-check"></i><b>13.3.4</b> 导航栏</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="Dashboards.html"><a href="Dashboards.html#shiny"><i class="fa fa-check"></i><b>13.4</b> Shiny</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="Dashboards.html"><a href="Dashboards.html#入门指南"><i class="fa fa-check"></i><b>13.4.1</b> 入门指南</a></li>
<li class="chapter" data-level="13.4.2" data-path="Dashboards.html"><a href="Dashboards.html#shiny-仪表盘的一个示例"><i class="fa fa-check"></i><b>13.4.2</b> Shiny 仪表盘的一个示例</a></li>
<li class="chapter" data-level="13.4.3" data-path="Dashboards.html"><a href="Dashboards.html#输入栏"><i class="fa fa-check"></i><b>13.4.3</b> 输入栏</a></li>
<li class="chapter" data-level="13.4.4" data-path="Dashboards.html"><a href="Dashboards.html#拓展"><i class="fa fa-check"></i><b>13.4.4</b> 拓展</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="shiny-started.html"><a href="shiny-started.html"><i class="fa fa-check"></i><b>14</b> Shiny</a>
<ul>
<li class="chapter" data-level="14.1" data-path="shiny-started.html"><a href="shiny-started.html#shiny-start"><i class="fa fa-check"></i><b>14.1</b> 入门指南</a></li>
<li class="chapter" data-level="14.2" data-path="shiny-started.html"><a href="shiny-started.html#shiny-deploy"><i class="fa fa-check"></i><b>14.2</b> 部署</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="shiny-started.html"><a href="shiny-started.html#shinyapps.io"><i class="fa fa-check"></i><b>14.2.1</b> ShinyApps.io</a></li>
<li class="chapter" data-level="14.2.2" data-path="shiny-started.html"><a href="shiny-started.html#shiny-server-rstudio-connect"><i class="fa fa-check"></i><b>14.2.2</b> Shiny Server / RStudio Connect</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="shiny-started.html"><a href="shiny-started.html#shiny-embedded"><i class="fa fa-check"></i><b>14.3</b> 嵌入 Shiny 应用程序</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="shiny-started.html"><a href="shiny-started.html#shiny-embed-inline"><i class="fa fa-check"></i><b>14.3.1</b> 内联应用程序</a></li>
<li class="chapter" data-level="14.3.2" data-path="shiny-started.html"><a href="shiny-started.html#外联应用程序"><i class="fa fa-check"></i><b>14.3.2</b> 外联应用程序</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="shiny-started.html"><a href="shiny-started.html#shiny-widgets"><i class="fa fa-check"></i><b>14.4</b> Shiny 小部件</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="shiny-started.html"><a href="shiny-started.html#shinyapp-函数"><i class="fa fa-check"></i><b>14.4.1</b> <code>shinyApp()</code> 函数</a></li>
<li class="chapter" data-level="14.4.2" data-path="shiny-started.html"><a href="shiny-started.html#例子k---means-聚类"><i class="fa fa-check"></i><b>14.4.2</b> 例子：k - means 聚类</a></li>
<li class="chapter" data-level="14.4.3" data-path="shiny-started.html"><a href="shiny-started.html#小部件的大小和布局"><i class="fa fa-check"></i><b>14.4.3</b> 小部件的大小和布局</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="shiny-started.html"><a href="shiny-started.html#shiny-multiple"><i class="fa fa-check"></i><b>14.5</b> 多页</a></li>
<li class="chapter" data-level="14.6" data-path="shiny-started.html"><a href="shiny-started.html#shiny-delay"><i class="fa fa-check"></i><b>14.6</b> 延迟渲染</a></li>
<li class="chapter" data-level="14.7" data-path="shiny-started.html"><a href="shiny-started.html#shiny-args"><i class="fa fa-check"></i><b>14.7</b> 渲染函数的输出参数</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="shiny-started.html"><a href="shiny-started.html#附加说明"><i class="fa fa-check"></i><b>14.7.1</b> 附加说明</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="custom-output.html"><a href="custom-output.html"><i class="fa fa-check"></i><b>15</b> 自定义排版</a>
<ul>
<li class="chapter" data-level="15.1" data-path="custom-output.html"><a href="custom-output.html#parameterized-report"><i class="fa fa-check"></i><b>15.1</b> 有参数的 R Markdown 报告</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="custom-output.html"><a href="custom-output.html#params-declare"><i class="fa fa-check"></i><b>15.1.1</b> 声明参数</a></li>
<li class="chapter" data-level="15.1.2" data-path="custom-output.html"><a href="custom-output.html#params-use"><i class="fa fa-check"></i><b>15.1.2</b> 使用参数</a></li>
<li class="chapter" data-level="15.1.3" data-path="custom-output.html"><a href="custom-output.html#params-knit"><i class="fa fa-check"></i><b>15.1.3</b> 有参编译</a></li>
<li class="chapter" data-level="15.1.4" data-path="custom-output.html"><a href="custom-output.html#params-publish"><i class="fa fa-check"></i><b>15.1.4</b> 发布文档</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="custom-output.html"><a href="custom-output.html#document-template"><i class="fa fa-check"></i><b>15.2</b> 文档模板</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="custom-output.html"><a href="custom-output.html#template-structure"><i class="fa fa-check"></i><b>15.2.1</b> 模板的结构</a></li>
<li class="chapter" data-level="15.2.2" data-path="custom-output.html"><a href="custom-output.html#template-support"><i class="fa fa-check"></i><b>15.2.2</b> 模板支持文件</a></li>
<li class="chapter" data-level="15.2.3" data-path="custom-output.html"><a href="custom-output.html#template-pandoc"><i class="fa fa-check"></i><b>15.2.3</b> 设置 Pandoc 模板</a></li>
<li class="chapter" data-level="15.2.4" data-path="custom-output.html"><a href="custom-output.html#template-share"><i class="fa fa-check"></i><b>15.2.4</b> 分享模板</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="custom-output.html"><a href="custom-output.html#new-formats"><i class="fa fa-check"></i><b>15.3</b> 创建新的文档格式</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="custom-output.html"><a href="custom-output.html#format-derive"><i class="fa fa-check"></i><b>15.3.1</b> 从现有文档格式衍生新格式</a></li>
<li class="chapter" data-level="15.3.2" data-path="custom-output.html"><a href="custom-output.html#fully-custom-format"><i class="fa fa-check"></i><b>15.3.2</b> 完全的自定义输出格式</a></li>
<li class="chapter" data-level="15.3.3" data-path="custom-output.html"><a href="custom-output.html#using-a-new-format"><i class="fa fa-check"></i><b>15.3.3</b> 使用新的文档输出格式</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Markdown 指南</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="knitr-misc" class="section level1" number="11">
<h1><span class="header-section-number">第 11 章</span> 其它使用 knitr 的小技巧</h1>
<p>除了块选项（参见第<a href="chunk-options.html#chunk-options">9</a>章）、输出钩子（参见第<a href="output-hooks.html#output-hooks">10</a>章）和块钩子（参见第<a href="#chunk-hooks"><strong>??</strong></a>章）之外，在<strong>knitr</strong>中还有很多有用的函数和技巧。我们将在本章中介绍这些技巧，例如重复使用代码块、提前退出编译、在自定义位置显示图像等等。</p>
<div id="reuse-chunks" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> 重复使用代码块</h2>
<p>哪怕不用复制黏贴，也可以在源文档中自由地重复使用代码块。这其中的关键点在于标记代码块，从而在其它地方用标签的形式引用它们。本节将介绍三种重复使用代码块的方法。</p>
<div id="embed-chunk" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> 将一个块嵌入到另一个块中 (*)</h3>
<p>将代码块的标签用<code>&lt;&lt;&gt;&gt;</code>括起来，则可以将该代码块嵌入到另一个代码块中。之后<strong>knitr</strong>将自动将其在实际代码中扩展为<code>&lt;&lt;label&gt;&gt;</code>。例如，可以这样创建一个R函数：</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb289-1"><a href="knitr-misc.html#cb289-1" aria-hidden="true" tabindex="-1"></a>我们定义了一个函数，可以将华氏度转为摄氏度。</span>
<span id="cb289-2"><a href="knitr-misc.html#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="knitr-misc.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f2c}</span></span>
<span id="cb289-4"><a href="knitr-misc.html#cb289-4" aria-hidden="true" tabindex="-1"></a><span class="in">F2C &lt;- function(x) {</span></span>
<span id="cb289-5"><a href="knitr-misc.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;&lt;check-arg&gt;&gt;</span></span>
<span id="cb289-6"><a href="knitr-misc.html#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="in">  &lt;&lt;convert&gt;&gt;</span></span>
<span id="cb289-7"><a href="knitr-misc.html#cb289-7" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb289-8"><a href="knitr-misc.html#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb289-9"><a href="knitr-misc.html#cb289-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-10"><a href="knitr-misc.html#cb289-10" aria-hidden="true" tabindex="-1"></a>首先，检查输入值是否为数字：</span>
<span id="cb289-11"><a href="knitr-misc.html#cb289-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-12"><a href="knitr-misc.html#cb289-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, check-arg, eval=FALSE}</span></span>
<span id="cb289-13"><a href="knitr-misc.html#cb289-13" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!is.numeric(x)) stop(&quot;The input must be numeric!&quot;)</span></span>
<span id="cb289-14"><a href="knitr-misc.html#cb289-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb289-15"><a href="knitr-misc.html#cb289-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-16"><a href="knitr-misc.html#cb289-16" aria-hidden="true" tabindex="-1"></a>然后进行转换：</span>
<span id="cb289-17"><a href="knitr-misc.html#cb289-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-18"><a href="knitr-misc.html#cb289-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, convert, eval=FALSE}</span></span>
<span id="cb289-19"><a href="knitr-misc.html#cb289-19" aria-hidden="true" tabindex="-1"></a><span class="in">  (x - 32) * 5/ 9</span></span>
<span id="cb289-20"><a href="knitr-misc.html#cb289-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>这是基于唐纳德·克努特（Donald Knuth）提出的<a href="https://en.wikipedia.org/wiki/Literate_programming">文学编程</a>的主要思想之一。这种技术的优点在于，你可以将（复杂的）代码分割成更小的部分，将每个部分写入单独的代码块中，并使用文字叙述来解释它们。所有的部分都可以被放入要执行的主代码块中。</p>
<p>在上面的例子中，第一个代码块（标签为<code>f2c</code>）将变成：</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb290-1"><a href="knitr-misc.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, f2c}</span></span>
<span id="cb290-2"><a href="knitr-misc.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="in">F2C &lt;- function(x) {</span></span>
<span id="cb290-3"><a href="knitr-misc.html#cb290-3" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!is.numeric(x)) stop(&quot;The input must be numeric!&quot;)</span></span>
<span id="cb290-4"><a href="knitr-misc.html#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="in">  (x - 32) * 5/ 9</span></span>
<span id="cb290-5"><a href="knitr-misc.html#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb290-6"><a href="knitr-misc.html#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>一个代码块中可以嵌入任意数量的其他代码块，并且嵌入也可以是递归的。例如，可以将块A嵌入到块B中，将块B嵌入到块C中，这样块C将借由块B包含块A中的代码。</p>
<p>另外，标记符<code>&lt;&lt;label&gt;&gt;</code>不必单独写成一行，它可以嵌入到代码块的任何地方。</p>
</div>
<div id="same-label" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> 在另一个块中使用相同的块标签</h3>
<p>如果你想要重复多次使用完全相同的代码块，则可以用一个标签来定义块，并使用相同的标签创建更多的代码块，但需要保留块的内容为空，例如：</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb291-1"><a href="knitr-misc.html#cb291-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-2"><a href="knitr-misc.html#cb291-2" aria-hidden="true" tabindex="-1"></a>下面是一个没有被运行的代码块：</span>
<span id="cb291-3"><a href="knitr-misc.html#cb291-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-4"><a href="knitr-misc.html#cb291-4" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, chunk-one, eval=FALSE}</span></span>
<span id="cb291-5"><a href="knitr-misc.html#cb291-5" aria-hidden="true" tabindex="-1"></a><span class="in">1 + 1</span></span>
<span id="cb291-6"><a href="knitr-misc.html#cb291-6" aria-hidden="true" tabindex="-1"></a><span class="in">2 + 2</span></span>
<span id="cb291-7"><a href="knitr-misc.html#cb291-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb291-8"><a href="knitr-misc.html#cb291-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-9"><a href="knitr-misc.html#cb291-9" aria-hidden="true" tabindex="-1"></a>现在我们运行该代码块：</span>
<span id="cb291-10"><a href="knitr-misc.html#cb291-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb291-11"><a href="knitr-misc.html#cb291-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, chunk-one, eval=TRUE}</span></span>
<span id="cb291-12"><a href="knitr-misc.html#cb291-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>在上面的例子中，我们使用了两次块标签<code>chunk-one</code>，第二个块只是重复使用了第一个块的代码。</p>
<p>我们建议你不要使用此方法多次（多于一次）运行代码块来生成图像或其他文件，因为从后面的块创建的图像文件可能会覆盖前一个块创建的文件。如果只有一个块使用块选项<code>eval = TRUE</code>，而所有其他块使用<code>eval = FALSE</code>的话是可以的。</p>
</div>
<div id="ref-label" class="section level3" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> 使用引用标签 (*)</h3>
<p>块选项<code>ref.label</code>利用一个由块标签组成的向量来检索这些块的内容。例如在下例中，标签为<code>chunk-a</code>的代码块是<code>chunk-c</code>和<code>chunk-b</code>的组合:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb292-1"><a href="knitr-misc.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-a, ref.label=c(&#39;chunk-c&#39;, &#39;chunk-b&#39;)}</span></span>
<span id="cb292-2"><a href="knitr-misc.html#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb292-3"><a href="knitr-misc.html#cb292-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-4"><a href="knitr-misc.html#cb292-4" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-b}</span></span>
<span id="cb292-5"><a href="knitr-misc.html#cb292-5" aria-hidden="true" tabindex="-1"></a><span class="in"># 这是块 b</span></span>
<span id="cb292-6"><a href="knitr-misc.html#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="in">1 + 1</span></span>
<span id="cb292-7"><a href="knitr-misc.html#cb292-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb292-8"><a href="knitr-misc.html#cb292-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb292-9"><a href="knitr-misc.html#cb292-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-c}</span></span>
<span id="cb292-10"><a href="knitr-misc.html#cb292-10" aria-hidden="true" tabindex="-1"></a><span class="in"># 这是块 c</span></span>
<span id="cb292-11"><a href="knitr-misc.html#cb292-11" aria-hidden="true" tabindex="-1"></a><span class="in">2 + 2</span></span>
<span id="cb292-12"><a href="knitr-misc.html#cb292-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>换句话说，<code>chunk-a</code>实际上是这样的：</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb293-1"><a href="knitr-misc.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunk-a}</span></span>
<span id="cb293-2"><a href="knitr-misc.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="in"># 这是块 c</span></span>
<span id="cb293-3"><a href="knitr-misc.html#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="in">2 + 2</span></span>
<span id="cb293-4"><a href="knitr-misc.html#cb293-4" aria-hidden="true" tabindex="-1"></a><span class="in"># 这是块 b</span></span>
<span id="cb293-5"><a href="knitr-misc.html#cb293-5" aria-hidden="true" tabindex="-1"></a><span class="in">1 + 1</span></span>
<span id="cb293-6"><a href="knitr-misc.html#cb293-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>块选项<code>ref.label</code>提供了一种非常灵活的方式，可以在文档中重新组织代码块，而无需采用剪切粘贴的方式。需要注意的是，被引用的代码块在使用<code>ref.label</code>的代码块之前还是之后并不重要，前面的代码块可以引用后面的代码块。</p>
<p>这个块选项的相关应用可参见<a href="#code-appendix"><strong>??</strong></a>节。</p>
</div>
</div>
<div id="load-cache" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> 在创建对象之前使用它 (*)</h2>
<p>一个<strong>knitr</strong>文档中的所有代码，包括代码块和行内R表达式中的代码，从开始到结束都是按先后顺序执行的。从理论上讲，在给变量赋值之前不能使用它。但是，在某些情况下，我们可能想在文档前面提到一个变量的值。例如，通常在文章的摘要中需要显示结果，但结果实际上是在文档的后面计算的。下面的例子说明了这个想法，但无法编译：</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb294-1"><a href="knitr-misc.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb294-2"><a href="knitr-misc.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="co">题目：一个重要的报告</span></span>
<span id="cb294-3"><a href="knitr-misc.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="co">摘要： &gt;</span></span>
<span id="cb294-4"><a href="knitr-misc.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="co">  在本文的分析中，`x` 的平均值是 `r mx`...</span></span>
<span id="cb294-5"><a href="knitr-misc.html#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb294-6"><a href="knitr-misc.html#cb294-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-7"><a href="knitr-misc.html#cb294-7" aria-hidden="true" tabindex="-1"></a>我们在下面的块中创建对象<span class="in">`mx`</span>：</span>
<span id="cb294-8"><a href="knitr-misc.html#cb294-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-9"><a href="knitr-misc.html#cb294-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb294-10"><a href="knitr-misc.html#cb294-10" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 1:100</span></span>
<span id="cb294-11"><a href="knitr-misc.html#cb294-11" aria-hidden="true" tabindex="-1"></a><span class="in">mx &lt;- mean(x)</span></span>
<span id="cb294-12"><a href="knitr-misc.html#cb294-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>要解决这个问题，对象的值必须先保存在某个地方，并在下一次编译文档时加载。需要注意的是，这一操作意味着文档至少需要被编译两次。下面的例子介绍了一章可能的解决方案，即使用<code>saveRDS()</code>函数：</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb295-1"><a href="knitr-misc.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb295-2"><a href="knitr-misc.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="in">mx &lt;- if (file.exists(&#39;mean.rds&#39;)) {</span></span>
<span id="cb295-3"><a href="knitr-misc.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS(&#39;mean.rds&#39;)</span></span>
<span id="cb295-4"><a href="knitr-misc.html#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="in">} else {</span></span>
<span id="cb295-5"><a href="knitr-misc.html#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="in">  &quot;The value of `mx` is not available yet&quot;</span></span>
<span id="cb295-6"><a href="knitr-misc.html#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb295-7"><a href="knitr-misc.html#cb295-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb295-8"><a href="knitr-misc.html#cb295-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-9"><a href="knitr-misc.html#cb295-9" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb295-10"><a href="knitr-misc.html#cb295-10" aria-hidden="true" tabindex="-1"></a>题目：一个重要的报告</span>
<span id="cb295-11"><a href="knitr-misc.html#cb295-11" aria-hidden="true" tabindex="-1"></a>摘要： &gt;</span>
<span id="cb295-12"><a href="knitr-misc.html#cb295-12" aria-hidden="true" tabindex="-1"></a>  在本文的分析中，<span class="in">`x`</span> 的平均值是</span>
<span id="cb295-13"><a href="knitr-misc.html#cb295-13" aria-hidden="true" tabindex="-1"></a>  <span class="in">`r mx`</span>...</span>
<span id="cb295-14"><a href="knitr-misc.html#cb295-14" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb295-15"><a href="knitr-misc.html#cb295-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-16"><a href="knitr-misc.html#cb295-16" aria-hidden="true" tabindex="-1"></a>我们在下面的块中创建对象<span class="in">`mx`</span>：</span>
<span id="cb295-17"><a href="knitr-misc.html#cb295-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-18"><a href="knitr-misc.html#cb295-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb295-19"><a href="knitr-misc.html#cb295-19" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 1:100</span></span>
<span id="cb295-20"><a href="knitr-misc.html#cb295-20" aria-hidden="true" tabindex="-1"></a><span class="in">mx &lt;- mean(x)</span></span>
<span id="cb295-21"><a href="knitr-misc.html#cb295-21" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(mx, &#39;mean.rds&#39;)</span></span>
<span id="cb295-22"><a href="knitr-misc.html#cb295-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>第一次编译本文档时，你将在摘要中看到短语 “The value of <code>mx</code> is not available yet”。之后当你再次编译它时，你将会看到<code>mx</code>的值。</p>
<p>函数<code>knitr::load_cache()</code>是一个替代的解决方案，它允许你在特定的代码块已经被缓存了之后从该代码块加载对象的值。这个想法与上面的例子类似，但它将减少手动保存和加载对象的工作，因为对象会自动保存到缓存数据库，只需要通过<code>load_cache()</code>加载它即可。下面是简化的例子：</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb296-1"><a href="knitr-misc.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb296-2"><a href="knitr-misc.html#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="co">题目：一个重要的报告</span></span>
<span id="cb296-3"><a href="knitr-misc.html#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="co">摘要： &gt;</span></span>
<span id="cb296-4"><a href="knitr-misc.html#cb296-4" aria-hidden="true" tabindex="-1"></a><span class="co">  在本文的分析中，`x` 的平均值是</span></span>
<span id="cb296-5"><a href="knitr-misc.html#cb296-5" aria-hidden="true" tabindex="-1"></a><span class="co">  `r knitr::load_cache(&#39;mean-x&#39;, &#39;mx&#39;)`.</span></span>
<span id="cb296-6"><a href="knitr-misc.html#cb296-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb296-7"><a href="knitr-misc.html#cb296-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-8"><a href="knitr-misc.html#cb296-8" aria-hidden="true" tabindex="-1"></a>我们在下面的块中创建对象<span class="in">`mx`</span>：</span>
<span id="cb296-9"><a href="knitr-misc.html#cb296-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-10"><a href="knitr-misc.html#cb296-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean-x, cache=TRUE}</span></span>
<span id="cb296-11"><a href="knitr-misc.html#cb296-11" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 1:100</span></span>
<span id="cb296-12"><a href="knitr-misc.html#cb296-12" aria-hidden="true" tabindex="-1"></a><span class="in">mx &lt;- mean(x)</span></span>
<span id="cb296-13"><a href="knitr-misc.html#cb296-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>在这个例子中，我们给R代码块添加了一个块标签<code>mean-x</code>（被传递给<code>load_cache()</code>函数），并使用块选项<code>cache = TRUE</code>来缓存它。此代码块中的所有对象都将被保存到缓存数据库中。同样的，你必须至少编译该文档两次，这样才能正确地从缓存数据库加载对象<code>mx</code>。如果<code>mx</code>的值今后不会被更改，则不需要再次编译该文档。</p>
<p>如果在<code>load_cache()</code>的第二个参数中没有指定对象名，整个缓存数据库将被加载到当前环境中。然后，你可以从缓存数据库中调用这些本应在后续的文档中被创建的对象，例如：</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="knitr-misc.html#cb297-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">load_cache</span>(<span class="st">&#39;mean-x&#39;</span>)</span>
<span id="cb297-2"><a href="knitr-misc.html#cb297-2" aria-hidden="true" tabindex="-1"></a>x   <span class="co"># 对象 `x`</span></span>
<span id="cb297-3"><a href="knitr-misc.html#cb297-3" aria-hidden="true" tabindex="-1"></a>mx  <span class="co"># 对象 `mx`</span></span></code></pre></div>
</div>
<div id="knit-exit" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> 提前退出编译</h2>
<p>有时，我们可能希望提前退出编译，而不是在文档的末尾退出。例如，我们可能正在进行一些分析，并且只希望分享结果的前半部分，或者可能文档末尾的一些代码尚未完成。在这些情况下，我们可以考虑在一个代码块中使用<code>knit_exit()</code>函数，它将在该代码块之后结束编译过程。</p>
<p>下面是一个简单的例子，我们有一个非常简单的块，并紧跟着有一个更耗时的块：</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb298-1"><a href="knitr-misc.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb298-2"><a href="knitr-misc.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="in">1 + 1</span></span>
<span id="cb298-3"><a href="knitr-misc.html#cb298-3" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::knit_exit()</span></span>
<span id="cb298-4"><a href="knitr-misc.html#cb298-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb298-5"><a href="knitr-misc.html#cb298-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-6"><a href="knitr-misc.html#cb298-6" aria-hidden="true" tabindex="-1"></a>在输出中你将只会看到上面的内容。</span>
<span id="cb298-7"><a href="knitr-misc.html#cb298-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-8"><a href="knitr-misc.html#cb298-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb298-9"><a href="knitr-misc.html#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="in">Sys.sleep(100)</span></span>
<span id="cb298-10"><a href="knitr-misc.html#cb298-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>一般情况下，你需要等待100秒来编译整个文档，但由于我们调用了<code>knit_exit()</code>，文档的剩余部分将不会被编译。</p>
</div>
<div id="fig-chunk" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> 生成一个图像并在其他地方显示</h2>
<p>通常情况下，由代码块中生成的图像会显示在代码块下面，但其实可以选择在其他地方显示它们，还可以在代码块中隐藏它们，例如：</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb299-1"><a href="knitr-misc.html#cb299-1" aria-hidden="true" tabindex="-1"></a>我们在这个代码块中生成了一个图像，但是没有显示出来：</span>
<span id="cb299-2"><a href="knitr-misc.html#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="knitr-misc.html#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cars-plot, dev=&#39;png&#39;, fig.show=&#39;hide&#39;}</span></span>
<span id="cb299-4"><a href="knitr-misc.html#cb299-4" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cars)</span></span>
<span id="cb299-5"><a href="knitr-misc.html#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb299-6"><a href="knitr-misc.html#cb299-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-7"><a href="knitr-misc.html#cb299-7" aria-hidden="true" tabindex="-1"></a>在另一段之后，我们介绍了该图像：</span>
<span id="cb299-8"><a href="knitr-misc.html#cb299-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-9"><a href="knitr-misc.html#cb299-9" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">一张好看的图</span><span class="co">]</span>(<span class="in">`r knitr::fig_chunk(&#39;cars-plot&#39;, &#39;png&#39;)`</span>)</span></code></pre></div>
<p>在代码块中，我们使用了块选项<code>fig.show='hide'</code>来把图像暂时隐藏起来。然后在另一段中，我们调用函数<code>knitr::fig_chunk()</code>来检索得到绘图文件的路径，例如<code>test_files/figure-html/cars-plot-1.png</code>。你需要将块标签和图像设备名称传递给<code>fig_chunk()</code>，以便它更好地得到图像文件路径。</p>
<p>在https://stackoverflow.com/a/46305297/559676上可以看到<code>fig_chunk()</code>在一个<strong>blogdown</strong>网站的应用。这个函数适用于任何R Markdown的输出格式，并且它对于在幻灯片上显示图像特别有用，因为幻灯片页上的屏幕空间通常是有限的，可以在一张幻灯片上展示代码，然后在另一张幻灯片上展示图像。</p>
</div>
<div id="global-device" class="section level2" number="11.5">
<h2><span class="header-section-number">11.5</span> 修改前一个代码块中的图像</h2>
<p>在默认情况的下，<strong>knitr</strong>会打开一个新的图像设备来记录每个新代码块产生的图像。这就带来了一个问题：不能轻易地修改之前代码块产生的图像，因为之前的图像设备已经关闭了。这对于基础的R图形通常是有问题的（但不会影响从<strong>ggplot2</strong> <span class="citation">(<a href="#ref-R-ggplot2" role="doc-biblioref"><strong>R-ggplot2?</strong></a>)</span>创建的网格图像，因为其可以被保存为R对象）。例如，如果我们在一个代码块中绘制一个图，并在后面的代码块中添加一条线，R将发出一个错误信号，表示还没有创建这个图，因此不能添加线。</p>
<p>如果想让图像设备对所有代码块均保持打开的状态，可以在文档的开头设置一个<strong>knitr</strong>包的选项：</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="knitr-misc.html#cb300-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_knit<span class="sc">$</span><span class="fu">set</span>(<span class="at">global.device =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>需要注意的是，这里使用的是<code>opts_knit</code>而非更常用的<code>opts_chunk</code>。相关例子可参见Stack Overflow的帖子https://stackoverflow.com/q/17502050。而当你不再需要这个全局的图像设备时，可以将该选项设置为<code>FALSE</code>。下面是一个完整的例子：</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb301-1"><a href="knitr-misc.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb301-2"><a href="knitr-misc.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &quot;使用全局图像设备记录图像&quot;</span></span>
<span id="cb301-3"><a href="knitr-misc.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb301-4"><a href="knitr-misc.html#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="knitr-misc.html#cb301-5" aria-hidden="true" tabindex="-1"></a>首先，开启全局图像设备：</span>
<span id="cb301-6"><a href="knitr-misc.html#cb301-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-7"><a href="knitr-misc.html#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb301-8"><a href="knitr-misc.html#cb301-8" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_knit$set(global.device = TRUE)</span></span>
<span id="cb301-9"><a href="knitr-misc.html#cb301-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb301-10"><a href="knitr-misc.html#cb301-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-11"><a href="knitr-misc.html#cb301-11" aria-hidden="true" tabindex="-1"></a>画一张图：</span>
<span id="cb301-12"><a href="knitr-misc.html#cb301-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-13"><a href="knitr-misc.html#cb301-13" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb301-14"><a href="knitr-misc.html#cb301-14" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = c(4, 4, 0.1, 0.1))</span></span>
<span id="cb301-15"><a href="knitr-misc.html#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cars)</span></span>
<span id="cb301-16"><a href="knitr-misc.html#cb301-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb301-17"><a href="knitr-misc.html#cb301-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-18"><a href="knitr-misc.html#cb301-18" aria-hidden="true" tabindex="-1"></a>给之前代码块生成的图添加一条线：</span>
<span id="cb301-19"><a href="knitr-misc.html#cb301-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-20"><a href="knitr-misc.html#cb301-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb301-21"><a href="knitr-misc.html#cb301-21" aria-hidden="true" tabindex="-1"></a><span class="in">fit &lt;- lm(dist ~ speed, data = cars)</span></span>
<span id="cb301-22"><a href="knitr-misc.html#cb301-22" aria-hidden="true" tabindex="-1"></a><span class="in">abline(fit)</span></span>
<span id="cb301-23"><a href="knitr-misc.html#cb301-23" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb301-24"><a href="knitr-misc.html#cb301-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-25"><a href="knitr-misc.html#cb301-25" aria-hidden="true" tabindex="-1"></a>不再使用全局图像设备了：</span>
<span id="cb301-26"><a href="knitr-misc.html#cb301-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-27"><a href="knitr-misc.html#cb301-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb301-28"><a href="knitr-misc.html#cb301-28" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_knit$set(global.device = FALSE)</span></span>
<span id="cb301-29"><a href="knitr-misc.html#cb301-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb301-30"><a href="knitr-misc.html#cb301-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-31"><a href="knitr-misc.html#cb301-31" aria-hidden="true" tabindex="-1"></a>画另一张图：</span>
<span id="cb301-32"><a href="knitr-misc.html#cb301-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-33"><a href="knitr-misc.html#cb301-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb301-34"><a href="knitr-misc.html#cb301-34" aria-hidden="true" tabindex="-1"></a><span class="in">plot(pressure, type = &#39;b&#39;)</span></span>
<span id="cb301-35"><a href="knitr-misc.html#cb301-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
</div>
<div id="opts-template" class="section level2" number="11.6">
<h2><span class="header-section-number">11.6</span> 保存一组块选项并重复使用它们 (*)</h2>
<p>如果你经常需要使用一些块选项，不妨把它们保存为一个组，然后只使用组的名称来重复使用它们。这可以通过<code>knitr::opts_template$set(name = list(options))</code>来实现，之后可以使用<code>opts.label</code>来引用组名，从而实现重复使用。例如：</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb302-1"><a href="knitr-misc.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, include=FALSE}</span></span>
<span id="cb302-2"><a href="knitr-misc.html#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_template$set(fullwidth = list(</span></span>
<span id="cb302-3"><a href="knitr-misc.html#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.width = 10, fig.height = 6,</span></span>
<span id="cb302-4"><a href="knitr-misc.html#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.retina = 2, out.width = &#39;100%&#39;</span></span>
<span id="cb302-5"><a href="knitr-misc.html#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="in">))</span></span>
<span id="cb302-6"><a href="knitr-misc.html#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb302-7"><a href="knitr-misc.html#cb302-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-8"><a href="knitr-misc.html#cb302-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, opts.label=&#39;fullwidth&#39;}</span></span>
<span id="cb302-9"><a href="knitr-misc.html#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cars)</span></span>
<span id="cb302-10"><a href="knitr-misc.html#cb302-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>在设定<code>opts.label = 'fullwidth'</code>时， <strong>knitr</strong>将从<code>knitr::opts_template</code>中读取块选项，并将它们应用到当前的块中，这样可以节省一些打字的工作量。如果一个块选项要在文档中全局使用，则应该考虑全局地设置它（参见第<a href="chunk-options.html#chunk-options">9</a>章）。</p>
<p>你还可以覆盖从<code>opts.label</code>中读取的选项，例如，如果你在下面的块中设置<code>fig.height = 7</code>，则实际的<code>fig.height</code>将变为<code>7</code>而非<code>6</code>，从而可以对单个块进行调整。</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb303-1"><a href="knitr-misc.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, opts.label=&#39;fullwidth&#39;, fig.height=7}</span></span>
<span id="cb303-2"><a href="knitr-misc.html#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cars)</span></span>
<span id="cb303-3"><a href="knitr-misc.html#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>事实上，你可以保存任意数量的分组选项，例如<code>knitr::opts_template$set(group1 = list(...), group2 = list(...))</code>。</p>
</div>
<div id="knit-expand" class="section level2" number="11.7">
<h2><span class="header-section-number">11.7</span> 使用 <code>knitr::knit_expand()</code> 来生成 Rmd 源代码</h2>
<p>函数<code>knitr::knit_expand()</code>可以将<code>{{ }}</code>中的表达式“扩展”为它的值（默认），例如，</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="knitr-misc.html#cb304-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">knit_expand</span>(<span class="at">text =</span> <span class="st">&quot;The value of `pi` is {{pi}}.&quot;</span>)</span>
<span id="cb304-2"><a href="knitr-misc.html#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;The value of `pi` is 3.14159265358979.&quot;</span></span>
<span id="cb304-3"><a href="knitr-misc.html#cb304-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">knit_expand</span>(</span>
<span id="cb304-4"><a href="knitr-misc.html#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="st">&quot;The value of `a` is {{a}}, so `a + 1` is {{a+1}}.&quot;</span>,</span>
<span id="cb304-5"><a href="knitr-misc.html#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb304-6"><a href="knitr-misc.html#cb304-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb304-7"><a href="knitr-misc.html#cb304-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;The value of `a` is 0.338, so `a + 1` is 1.338.&quot;</span></span></code></pre></div>
<p>这意味着，如果你有一个Rmd文档，其中包含了<code>{{ }}</code>中的一些动态部分，那么可以在该文档上应用<code>knit_expand()</code>，然后调用<code>knit()</code>来编译它。例如，下面是一个名为<code>template.Rmd</code>的模板文档：</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb305-1"><a href="knitr-misc.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 在 {{i}} 上进行回归</span></span>
<span id="cb305-2"><a href="knitr-misc.html#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="knitr-misc.html#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lm-{{i}}}</span></span>
<span id="cb305-4"><a href="knitr-misc.html#cb305-4" aria-hidden="true" tabindex="-1"></a><span class="in">lm(mpg ~ {{i}}, data = mtcars)</span></span>
<span id="cb305-5"><a href="knitr-misc.html#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>我们可以用<code>mpg</code>来对<code>mtcars</code>数据集中的所有其他变量逐个建立线性回归模型：</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb306-1"><a href="knitr-misc.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, results=&#39;asis&#39;}</span></span>
<span id="cb306-2"><a href="knitr-misc.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="in">src = lapply(setdiff(names(mtcars), &#39;mpg&#39;), function(i) {</span></span>
<span id="cb306-3"><a href="knitr-misc.html#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="in">  knitr::knit_expand(&#39;template.Rmd&#39;)</span></span>
<span id="cb306-4"><a href="knitr-misc.html#cb306-4" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb306-5"><a href="knitr-misc.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="in">res = knitr::knit_child(text = unlist(src), quiet = TRUE)</span></span>
<span id="cb306-6"><a href="knitr-misc.html#cb306-6" aria-hidden="true" tabindex="-1"></a><span class="in">cat(res, sep = &#39;\n&#39;)</span></span>
<span id="cb306-7"><a href="knitr-misc.html#cb306-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>如果理解这个例子有难度，可参阅<a href="chunk-options.html#results-asis">9.11</a>节，以了解块选项<code>results = 'asis'</code>，以及<a href="#child-document"><strong>??</strong></a>节来了解<code>knitr::knit_child()</code>的用法。</p>
</div>
<div id="duplicate-label" class="section level2" number="11.8">
<h2><span class="header-section-number">11.8</span> 允许代码块中的标签重复 Allow duplicate labels in code chunks (*)</h2>
<!-- https://stackoverflow.com/questions/36868287/purl-within-knit-duplicate-label-error/47065392#47065392 -->
<p>默认情况下，<strong>knitr</strong>不允许在文档中重复代码块标签。在编译文档时，重复的标签将导致错误。这种情况常见于在文档中复制和粘贴代码块的时候，会产生这样的错误信息：</p>
<pre class="text"><code>processing file: myfile.Rmd
Error in parse_block(g[-1], g[1], params.src, markdown_mode) :
  Duplicate chunk label &#39;cars&#39;
Calls: &lt;Anonymous&gt; ... process_file -&gt; split_file -&gt; lapply -&gt;
  FUN -&gt; parse_block
Execution halted</code></pre>
<p>然而，在某些情况下，我们希望允许标签可以重复。例如，如果我们有一个母文档<code>parent.Rmd</code>，在其中我们会多次编译子文档，下面的代码会运行失败：</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="knitr-misc.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置</span></span>
<span id="cb308-2"><a href="knitr-misc.html#cb308-2" aria-hidden="true" tabindex="-1"></a>settings <span class="ot">=</span> <span class="fu">list</span>(...)</span>
<span id="cb308-3"><a href="knitr-misc.html#cb308-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-4"><a href="knitr-misc.html#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 第一次运行</span></span>
<span id="cb308-5"><a href="knitr-misc.html#cb308-5" aria-hidden="true" tabindex="-1"></a><span class="fu">knit_child</span>(<span class="st">&#39;useful_analysis.Rmd&#39;</span>)</span>
<span id="cb308-6"><a href="knitr-misc.html#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="knitr-misc.html#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 重新设置</span></span>
<span id="cb308-8"><a href="knitr-misc.html#cb308-8" aria-hidden="true" tabindex="-1"></a>settings <span class="ot">=</span> <span class="fu">list</span>(...)</span>
<span id="cb308-9"><a href="knitr-misc.html#cb308-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-10"><a href="knitr-misc.html#cb308-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 再次运行</span></span>
<span id="cb308-11"><a href="knitr-misc.html#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="fu">knit_child</span>(<span class="st">&#39;useful_analysis.Rmd&#39;</span>)</span></code></pre></div>
<p>在这个场景中，我们可以通过在编译子文档之前在R中设置这个全局选项来允许标签可重复：</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="knitr-misc.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.duplicate.label =</span> <span class="st">&#39;allow&#39;</span>)</span></code></pre></div>
<p>如果你想在母文档而不是子文档中允许标签可重复，则必须在<code>knitr::knit()</code>被调用之前设置这个选项。一种可能的方法是在<code>~/.Rprofile</code>中设置这个选项（更多信息可参见帮助页面<code>?Rprofile</code>）。</p>
<p>设置此选项时需要很谨慎，与大多数的报错一样，它们的存在是有原因的。允许重复的块可能会在图像和交叉引用方面产生静默问题（silent problem）。例如，理论上，如果两个代码块具有相同的标签，并且两个代码块都生成图像，那么它们的图像文件将互相覆盖（并不会产生错误或警告消息），因为图像的文件名是由块标签决定的。使用选项<code>knitr.duplicate.label = "allow"</code>时， <strong>knitr</strong>将通过添加数字后缀来静默地改变重复标签。例如，对于两个代码块：</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb310-1"><a href="knitr-misc.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, test}</span></span>
<span id="cb310-2"><a href="knitr-misc.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="in">plot(1:10)</span></span>
<span id="cb310-3"><a href="knitr-misc.html#cb310-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb310-4"><a href="knitr-misc.html#cb310-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-5"><a href="knitr-misc.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, test}</span></span>
<span id="cb310-6"><a href="knitr-misc.html#cb310-6" aria-hidden="true" tabindex="-1"></a><span class="in">plot(10:1)</span></span>
<span id="cb310-7"><a href="knitr-misc.html#cb310-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>第二个标签将被静默地更改为<code>test-1</code>，这将避免覆盖由标签<code>test</code>的块产生的图像，但这也使得块标签不可被预知，所以在交叉引用图像时可能会产生困难（参见 <a href="#cross-ref"><strong>??</strong></a>节），因为交叉引用也是基于块标签的。</p>
</div>
<div id="cache-rds" class="section level2" number="11.9">
<h2><span class="header-section-number">11.9</span> 一个更透明的缓存机制</h2>
<p>如果你觉得在<a href="chunk-options.html#cache">9.4</a>节中介绍的<strong>knitr</strong>的缓存机过于复杂（确实如此!），可以考虑使用基于函数<code>xfun::cache_rds()</code>的一个更简单的缓存机制，例如：</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="knitr-misc.html#cb311-1" aria-hidden="true" tabindex="-1"></a>xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb311-2"><a href="knitr-misc.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 在这里编写你的耗时代码</span></span>
<span id="cb311-3"><a href="knitr-misc.html#cb311-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>关于<strong>knitr</strong>缓存，其棘手之处在于如何决定何时使缓存失效，而使用<code>xfun::cache_rds()</code>则要清楚得多：第一次将R表达式传递给这个函数时，它会计算表达式并将结果保存到<code>.rds</code>文件中；下次再次运行<code>cache_rds()</code>时，它会读取<code>.rds</code>的文件，并立即返回结果，而不再次计算表达式。使缓存无效的最明显的方法是删除<code>.rds</code>的文件。如果不想手动删除它，则可以用参数<code>rerun = TRUE</code>来调用<code>xfun::cache_rds()</code>。</p>
<p>当<code>xfun::cache_rds()</code> 在<strong>knitr</strong>源文档的一个代码块中被调用时，<code>.rds</code>文件的路径由块选项<code>cache.path</code>和块标签决定。例如，对于在Rmd文档<code>input.Rmd</code>中带有块标签<code>foo</code>的代码块：</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb312-1"><a href="knitr-misc.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, foo}</span></span>
<span id="cb312-2"><a href="knitr-misc.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="in">res &lt;- xfun::cache_rds({</span></span>
<span id="cb312-3"><a href="knitr-misc.html#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="in">  Sys.sleep(3)</span></span>
<span id="cb312-4"><a href="knitr-misc.html#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="in">  1:10</span></span>
<span id="cb312-5"><a href="knitr-misc.html#cb312-5" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb312-6"><a href="knitr-misc.html#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p><code>.rds</code>文件的路径格式为<code>input_cache/FORMAT/foo_HASH.rds</code>，其中<code>FORMAT</code>是Pandoc输出格式名称（例如<code>html</code>或<code>latex</code>）， <code>HASH</code>是一个MD5哈希，包含了32个十六进制数字（a-f<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>和0-9），例如<code>input_cache/html/foo_7a3f22c4309d400eff95de0e8bddac71.rds</code>。</p>
<p>如帮助页面<code>?xfun::cache_rds</code>所述，通常在两种的情况下可能想要使缓存失效：1）待求值表达式中的代码发生了变化；2）代码使用了一个外部变量，并且该变量的值已经改变。接下来，我们将解释这两种情况下缓存是如何失效的，以及如何将缓存的多个副本保存到对应于不同版本的代码中。</p>
<div id="通过更改表达式中的代码使缓存失效" class="section level3" number="11.9.1">
<h3><span class="header-section-number">11.9.1</span> 通过更改表达式中的代码使缓存失效</h3>
<p>当你改变<code>cache_rds()</code>中的代码时（例如，从<code>cache_rds({x + 1})</code>改为<code>cache_rds({x + 2})</code>），缓存将自动失效，表达式将被重新计算。但是，需要注意的是，空格或注释的变化并不重要，或者一般来说，只要更改不影响已解析的表达式，缓存就不会失效。例如，下面传递给<code>cache_rds()</code>的两个表达式在本质上是相同的：</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="knitr-misc.html#cb313-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb313-2"><a href="knitr-misc.html#cb313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">3</span>);</span>
<span id="cb313-3"><a href="knitr-misc.html#cb313-3" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>;  <span class="co"># 分号不影响</span></span>
<span id="cb313-4"><a href="knitr-misc.html#cb313-4" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb313-5"><a href="knitr-misc.html#cb313-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb313-6"><a href="knitr-misc.html#cb313-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-7"><a href="knitr-misc.html#cb313-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb313-8"><a href="knitr-misc.html#cb313-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">3</span>)</span>
<span id="cb313-9"><a href="knitr-misc.html#cb313-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>  <span class="co"># 一个注释</span></span>
<span id="cb313-10"><a href="knitr-misc.html#cb313-10" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span></span>
<span id="cb313-11"><a href="knitr-misc.html#cb313-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>  <span class="co"># 可以随意修改空格部分</span></span>
<span id="cb313-12"><a href="knitr-misc.html#cb313-12" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>因此，如果对第一个表达式执行<code>cache_rds()</code>，那么第二个表达式将能够调用缓存的结果。这一特性非常有用，因为其允许在代码中进行修饰性更改，而不会使缓存失效。</p>
<p>如果不确定两个版本的代码是否相等，则可以尝试下面的<code>parse_code()</code>函数：</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="knitr-misc.html#cb314-1" aria-hidden="true" tabindex="-1"></a>parse_code <span class="ot">&lt;-</span> <span class="cf">function</span>(expr) {</span>
<span id="cb314-2"><a href="knitr-misc.html#cb314-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">deparse</span>(<span class="fu">substitute</span>(expr))</span>
<span id="cb314-3"><a href="knitr-misc.html#cb314-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb314-4"><a href="knitr-misc.html#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 空格或分号不影响</span></span>
<span id="cb314-5"><a href="knitr-misc.html#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_code</span>({x<span class="sc">+</span><span class="dv">1</span>})</span></code></pre></div>
<pre><code>## [1] &quot;{&quot;         &quot;    x + 1&quot; &quot;}&quot;</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="knitr-misc.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_code</span>({ x   <span class="sc">+</span>    <span class="dv">1</span>; })</span></code></pre></div>
<pre><code>## [1] &quot;{&quot;         &quot;    x + 1&quot; &quot;}&quot;</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="knitr-misc.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 左箭头和右箭头是等价的</span></span>
<span id="cb318-2"><a href="knitr-misc.html#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">parse_code</span>({x <span class="ot">&lt;-</span> <span class="dv">1</span>}), <span class="fu">parse_code</span>({<span class="dv">1</span> <span class="ot">-&gt;</span> x}))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="通过更改全局变量使缓存失效" class="section level3" number="11.9.2">
<h3><span class="header-section-number">11.9.2</span> 通过更改全局变量使缓存失效</h3>
<p>通常情况下，表达式中有两种类型的变量：全局变量和局部变量。全局变量是在表达式外部创建的，局部变量则是在表达式内部创建的。如果表达式中全局变量的值发生了变化，那么缓存的结果和再次运行的结果之间可能会产生差异。例如，在下面的表达式中，如果<code>y</code>发生了变化，你可能想要使缓存失效并重新运行表达式，否则你仍然会得到根据<code>y</code>之前的值计算得到的结果：</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="knitr-misc.html#cb320-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb320-2"><a href="knitr-misc.html#cb320-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-3"><a href="knitr-misc.html#cb320-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb320-4"><a href="knitr-misc.html#cb320-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb320-5"><a href="knitr-misc.html#cb320-5" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb320-6"><a href="knitr-misc.html#cb320-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>如果要使缓存当<code>y</code>发生变化时失效，你可以则需要通过<code>hash</code>参数，让<code>cache_rds()</code>在决定缓存是否应该失效时知道需要考虑<code>y</code>：</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="knitr-misc.html#cb321-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb321-2"><a href="knitr-misc.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb321-3"><a href="knitr-misc.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb321-4"><a href="knitr-misc.html#cb321-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">hash =</span> <span class="fu">list</span>(y))</span></code></pre></div>
<p>当<code>hash</code>参数的值改变时，缓存文件名中的32位哈希值（如前所述）会相应地改变，导致缓存失效。这提供了一种方法来指定缓存与其他R对象的依赖关系。例如，如果想要使缓存依赖于R的版本，可以这样指定依赖：</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="knitr-misc.html#cb322-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb322-2"><a href="knitr-misc.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb322-3"><a href="knitr-misc.html#cb322-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb322-4"><a href="knitr-misc.html#cb322-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">hash =</span> <span class="fu">list</span>(y, <span class="fu">getRversion</span>()))</span></code></pre></div>
<p>或者，如果你想让缓存依赖于数据文件最后一次修改的时间，则可这样做：</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="knitr-misc.html#cb323-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb323-2"><a href="knitr-misc.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data.csv&quot;</span>)</span>
<span id="cb323-3"><a href="knitr-misc.html#cb323-3" aria-hidden="true" tabindex="-1"></a>  x[[<span class="dv">1</span>]] <span class="sc">+</span> y</span>
<span id="cb323-4"><a href="knitr-misc.html#cb323-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">hash =</span> <span class="fu">list</span>(y, <span class="fu">file.mtime</span>(<span class="st">&quot;data.csv&quot;</span>)))</span></code></pre></div>
<p>如果你不想为<code>hash</code>参数提供全局变量的列表，则可以尝试<code>hash = "auto"</code>，它将使<code>cache_rds()</code>自动找出所有的全局变量，并将它们作为<code>hash</code>参数的值，例如：</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="knitr-misc.html#cb324-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb324-2"><a href="knitr-misc.html#cb324-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb324-3"><a href="knitr-misc.html#cb324-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y <span class="sc">+</span> z  <span class="co"># y 和 z 是全局变量</span></span>
<span id="cb324-4"><a href="knitr-misc.html#cb324-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">hash =</span> <span class="st">&quot;auto&quot;</span>)</span></code></pre></div>
<p>这等价于：</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="knitr-misc.html#cb325-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb325-2"><a href="knitr-misc.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb325-3"><a href="knitr-misc.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y <span class="sc">+</span> z  <span class="co"># y and z are global variables</span></span>
<span id="cb325-4"><a href="knitr-misc.html#cb325-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">hash =</span> <span class="fu">list</span>(<span class="at">y =</span> y, <span class="at">z =</span> z))</span></code></pre></div>
<p>当<code>hash = "auto"</code>时，全局变量由<code>codetools::findGlobals()</code>识别，这可能不是完全可靠的，所以如果你想要完全确定哪些变量可以使缓存失效，我们建议你在<code>hash</code>参数中亲自给定变量列表。</p>
</div>
<div id="保留缓存的多个副本" class="section level3" number="11.9.3">
<h3><span class="header-section-number">11.9.3</span> 保留缓存的多个副本</h3>
<p>由于缓存通常用于非常耗时的代码，在使其失效时应保守一些。你可能会因过早地或主动地使缓存失效而后悔，因为如果你再次需要一个旧版本的缓存，则将不得不等待很长的时间才能重新完成计算。</p>
<p>若将<code>cache_rds()</code>中的<code>clean</code>参数设置为<code>FALSE</code>，则其将允许你保留旧的缓存副本。你也可以设置全局R选项<code>options(xfun.cache_rds.clean = FALSE)</code>来使其成为文档的默认行为。在默认情况下，<code>clean = TRUE</code>和<code>cache_rds()</code>每次都会尝试删除旧的缓存。如果你还在进行代码测试，那么设置<code>clean = FALSE</code>会很有用。例如，可以缓存一个线性模型的两个版本：</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="knitr-misc.html#cb326-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb326-2"><a href="knitr-misc.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data =</span> cars)</span>
<span id="cb326-3"><a href="knitr-misc.html#cb326-3" aria-hidden="true" tabindex="-1"></a>}, <span class="at">clean =</span> <span class="cn">FALSE</span>)</span>
<span id="cb326-4"><a href="knitr-misc.html#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="knitr-misc.html#cb326-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb326-6"><a href="knitr-misc.html#cb326-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">+</span> <span class="fu">I</span>(speed<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> cars)</span>
<span id="cb326-7"><a href="knitr-misc.html#cb326-7" aria-hidden="true" tabindex="-1"></a>}, <span class="at">clean =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>在决定使用哪个模型之后，你可以再次设置<code>clean = TRUE</code>，或者删除<code>clean</code>参数（默认为<code>TRUE</code>）。</p>
</div>
<div id="与knitr的缓存比较" class="section level3" number="11.9.4">
<h3><span class="header-section-number">11.9.4</span> 与<strong>knitr</strong>的缓存比较</h3>
<p>你可能想知道什么时候使用<strong>knitr</strong>的缓存（例如，设置块选项<code>cache = TRUE</code>），什么时候在<strong>knitr</strong>源文档中使用<code>xfun::cache_rds()</code>。后者最大的缺点是它不缓存副产物（而只缓存表达式的值），而<strong>knitr</strong>却可以。一些副产物可能是有用的，例如打印的输出或图像。例如，在下面的代码中，当使用<code>cache_rds()</code>加载缓存时，文本输出和图像将会丢失，只会返回<code>1:10</code>：</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="knitr-misc.html#cb327-1" aria-hidden="true" tabindex="-1"></a>xfun<span class="sc">::</span><span class="fu">cache_rds</span>({</span>
<span id="cb327-2"><a href="knitr-misc.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;Hello world!&quot;</span>)</span>
<span id="cb327-3"><a href="knitr-misc.html#cb327-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cars)</span>
<span id="cb327-4"><a href="knitr-misc.html#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb327-5"><a href="knitr-misc.html#cb327-5" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>相比之下，对于设定选项为<code>cache = TRUE</code>的代码块，所有的内容都将被缓存：</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb328-1"><a href="knitr-misc.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, cache=TRUE}</span></span>
<span id="cb328-2"><a href="knitr-misc.html#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="in">print(&quot;Hello world!&quot;)</span></span>
<span id="cb328-3"><a href="knitr-misc.html#cb328-3" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cars)</span></span>
<span id="cb328-4"><a href="knitr-misc.html#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="in">1:10</span></span>
<span id="cb328-5"><a href="knitr-misc.html#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p><strong>knitr</strong>的缓存最大的缺点（同时也是用户最常抱怨的）是缓存可能会在不经意间失效，因为缓存由太多的因素所决定。例如，任何块选项的改变都会使缓存失效<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>，但有些块选项可能与计算无关。在下面的代码块中，改变块选项<code>fig.width = 6</code>到<code>fig.width = 10</code>不应该使缓存失效，但事实上它会：</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb329-1"><a href="knitr-misc.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, cache=TRUE, fig.width=6}</span></span>
<span id="cb329-2"><a href="knitr-misc.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="in"># 这个块没有生成图像</span></span>
<span id="cb329-3"><a href="knitr-misc.html#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- rnorm(1000)</span></span>
<span id="cb329-4"><a href="knitr-misc.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="in">mean(x)</span></span>
<span id="cb329-5"><a href="knitr-misc.html#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>实际上，<strong>knitr</strong>的缓存非常强大且灵活，它的行为可以通过多种方式进行调整。它的作者也经常怀疑是否值得介绍这些不太为人所知的特性，因为可能会导致使用者花更多的时间来学习和理解缓存如何工作，而非运行实际的代码。</p>
<p>在不清楚用哪个的情况下，<code>xfun::cache_rds()</code>是缓存计算结果的通用方法，它可以在任何地方使用，而<strong>knitr</strong>的缓存只能在<strong>knitr</strong>文档中使用。</p>

</div>
</div>
</div>



<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>原文为a-z。<a href="knitr-misc.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>这是默认的行为，你也可以进行调整。如果想了解如何使缓存更精细，而非所有块选项都会影响缓存，请参阅https://yihui.org/knitr/demo/cache/。<a href="knitr-misc.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="output-hooks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-languages.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cosname/rmarkdown-guide/edit/master/15.5-knitr-misc.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
